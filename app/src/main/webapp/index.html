<!DOCTYPE html>
<html>

<head lang="en">
	<title>首页</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="/js/bootstrap-4.1.1-dist/css/bootstrap.min.css">
	<script src="/js/jquery/jquery.min.js"></script>
	<script src="/js/bootstrap-4.1.1-dist/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="/css/font/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/reset.css" rel="stylesheet" >
	<link rel="stylesheet" href="/css/index.css" rel="stylesheet">
	<script src="/js/plugins/jrender/jrender.min.js"></script>
	<link rel="stylesheet" href="/js/plugins/dialog2/dialog.css">
	<script src="/js/plugins/dialog2/dialog.min.js"></script>
	<script src="/js/common.js"></script>


	<script>
		$(function () {
            //搜索关键字按钮
            $("#searchBtn").click(function () {
                var keyword = $("#search").val();
                if(keyword){
                    //将输入的关键字保存到sessionStorage中
                    sessionStorage.setItem("keyword",JSON.stringify(keyword));
                    window.location.href='/search.html'
                }else {
                    $(document).dialog({
                        type: 'notice',
                        content: '<span class="info-text">请输入要搜索的关键字!</span>',
                        autoClose: 2500
                    });
                }
            })





		    //加载侧边栏的时候带上毫秒值,解决缓存问题
			$("#ipage").attr('src',"/mine/simpleProfiles.html?"+new Date().getTime());

			//获取每周推荐数据
			$.get('/travels/commends',{type:1,pageSize:3},function (data) {
			    //渲染数据
				$("#travelsCommends").renderValues(data,{
                    getHref:getHref
				});

				//为第一个item添加active
				$(".carousel-item:first").addClass("active");

            })

            $.get('/dailies', {pageSize: 3}, function (data) {
                $("#dailyCommends1").renderValues(data.list[0], {
                    getHref: function (item, value) {
                        var url = $(item).data("href");
                        $(item).attr("href", url + value);
                    }
                });
                $("#dailyCommends2").renderValues(data.list[1], {
                    getHref: function (item, value) {
                        var url = $(item).data("href");
                        $(item).attr("href", url + value);
                    }
                });
                $("#dailyCommends3").renderValues(data.list[2], {
                    getHref: function (item, value) {
                        var url = $(item).data("href");
                        $(item).attr("href", url + value);
                    }
                });

            });
        })
	</script>

</head>


<body>

<div class="body">
	<input type="checkbox" id="menu">

	<label for="menu" class="menu">
		<span><i class="fa fa-user fa-fw fa-2x"></i></span>
		<span><i class="fa fa-chevron-left fa-fw fa-2x" style="color: #3E3C3B"></i></span>
	</label>

	<!-- 侧边栏 -->
	<div class="nav">
		<iframe id="ipage"  frameborder="0" width="90%"></iframe>
	</div>

	<div class="search-head">
		<div class="row nav-search">
			<div class="col-1">
				<a href="index.html">
					<span><i class="fa fa-chevron-left fa-2x"></i></span>
				</a>
			</div>
			<div class="col-8">
				<div class="input-group-sm search">
					<input id="search" class="form-control" placeholder="找攻略/游记/用户/日报"  >
				</div>
			</div>
			<div class="col-1">
				<i class="fa fa-search" id="searchBtn" style="color:white;font-size:25px;position: absolute;top: 23%;left: 88%">
				</i>
			</div>
		</div>
	</div>

	<div class="container">
		<h6 class="module-title">每周推荐</h6>
		<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
			<div id="travelsCommends">
				<div class="carousel-inner"  render-loop="list">
					<div class="carousel-item ">
						<a render-key="list.t_id" render-fun="getHref" data-href="/travelContent.html?id=">
							<img class="d-block w-100"  render-src="list.coverUrl" width="100%" height="200px">
							<span class="recommend" render-html="list.title"></span></a>
						<div class="recommend-author">
							<a render-key="list.u_id" render-fun="getHref" data-href="/userProfiles.html?id=">
								<img  class="rounded-circle" style="width: 10%;" render-src="list.u_headImgUrl">
								<span render-html="list.u_nickName"></span>
							</a>
							在&nbsp;
							<span render-html="list.r_name">广州</span>
						</div>
					</div>
				</div>
			</div>
			<a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="sr-only"></span>
			</a>
			<a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="sr-only"></span>
			</a>
		</div>
		<hr>

		<div class="row nav-box">
			<div class="col" style="background-color: #DFE823;" align="center">
				<a href="strategyPage.html"><i class="fa fa-plane fa-fw"></i> 找攻略</a>
			</div>
			<div class="col" style="background-color: #7281D5;" align="center">
				<a href="travelPage.html"><i class="fa fa-book fa-fw"></i> 看游记</a>
			</div>
			<div class="col" style="background-color: #7281D5;" align="center">
				<a href="hotel.html"><i class="fa fa-plane fa-fw"></i> 酒店</a>
			</div>
			<div class="col" style="background-color: #7281D5;" align="center">
				<a href="hotel.html"><i class="fa fa-plane fa-fw"></i> 我的订单</a>
			</div>
		</div>

		<div class="row dynamic " id="comments">
			<div class="col-1" style="padding: 0px;">
				<img class="rounded" src="/img/topComment.png" style="width: 50px;">
			</div>
			<div class="col">
				<div class="Marquee"  >
					<div class="d-flex">
					<a href="userProfiles.html" >
						<img  class="rounded-circle dynamic-head" src="/upload/6610317b-2077-4bd3-98c7-7d31b6613469.jpg">
					</a>
					<a href="strategyComment.html"  class="dynamic-detail" data-id="1">
						<span>叩丁狼</span> 点评了攻略<p >广州攻略</p>
					</a>
				</div><div class="d-flex">
					<a href="userProfiles.html" >
						<img class="rounded-circle dynamic-head" src="/upload/23a45130-e59c-4844-bc52-67aed3d57fc1.jpeg">
					</a>
					<a href="strategyComment.html"  class="dynamic-detail" >
						<span >喵喵</span> 点评了攻略<p >广州攻略</p>
					</a>
				</div></div>
			</div>
		</div>
	</div>

	<hr>

	<div class="container">
		<h6 class="module-title">骡窝日报 <a href="/newsPage.html">更多</a></h6>
		<div id="dailyCommends1">
			<div class="news" id="bigger">
				<a data-href="newsContent.html?id=" render-key="id" render-fun="getHref">
					<img width="100%" render-src="coverUrl">
					<div class="caption">
						<h5 render-html="title"></h5>
						<p render-html="subTitle"></p>
					</div>
				</a>
			</div>
		</div>
		<hr>
		<div id="smaller">
			<div id="dailyCommends2">
				<div style="margin-bottom: 20px">
					<a data-href="newsContent.html?id=" render-key="id" render-fun="getHref">
						<div class="row news-detail">
							<div class="col-5">
								<img render-src="coverUrl">
							</div>
							<div class="col-7">
								<h4 render-html="title"></h4>
								<p render-html="subTitle"></p>
							</div>
						</div>
					</a>
					<hr>
				</div>
			</div>
			<div id="dailyCommends3">
				<div style="margin-bottom: 20px">
					<a data-href="newsContent.html?id=" render-key="id" render-fun="getHref">
						<div class="row news-detail">
							<div class="col-5">
								<img render-src="coverUrl">
							</div>
							<div class="col-7">
								<h4 render-html="title"></h4>
								<p render-html="subTitle"></p>
							</div>
						</div>
					</a>
					<hr>
				</div>
			</div>
		</div>
	</div>
</div>


<script>

        $(function () {
			showComments();
        })

		function showComments(){
			var Mar = document.getElementsByClassName("Marquee")[0];
			var child_div=Mar.getElementsByTagName("div");
			var picH = 50;//移动高度
			var scrollstep=3;//移动步幅,越大越快
			var scrolltime=20;//移动频度(毫秒)越大越慢
			var stoptime=3000;//间断时间(毫秒)
			var tmpH = 0;
			Mar.innerHTML += Mar.innerHTML;
			function start(){
				if(tmpH < picH){
					tmpH += scrollstep;
					if(tmpH > picH )tmpH = picH ;
					Mar.scrollTop = tmpH;
					setTimeout(start,scrolltime);
				}else{
					tmpH = 0;
					Mar.appendChild(child_div[0]);
					Mar.scrollTop = 0;
					setTimeout(start,stoptime);
				}
			}
			setTimeout(start,stoptime)
		}
	</script>
</body>

</html>